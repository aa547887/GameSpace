@model GameSpace.Models.Mute
@{
    ViewData["Title"] = "詞彙明細";

    bool canManage = (bool)(ViewBag.CanManageMutes ?? false);
    bool canAdminAll = (bool)(ViewBag.CanAdminAll ?? false);
    int currentMid = (int)(ViewBag.ManagerId ?? 0);

    bool canEditThis = canManage && (canAdminAll || (Model.ManagerId.HasValue && Model.ManagerId.Value == currentMid));
    string managerName = ViewBag.ManagerName as string ?? "-";
}

<div class="mutes-header">
    <h2 class="mutes-title">
        <span>@ViewData["Title"]</span>
        @if (!canManage)
        {
            <span class="badge rounded-pill badge-readonly">唯讀</span>
        }
        else if (!canEditThis)
        {
            <span class="badge rounded-pill bg-warning text-dark">僅可管理自己建立</span>
        }
        else
        {
            <span class="badge rounded-pill badge-manage">可管理</span>
        }
    </h2>
    <div class="mutes-subtle">
        <span class="me-3"><i class="far fa-clock me-1"></i>@Html.AppTime(Model?.CreatedAt, "yyyy/MM/dd HH:mm")</span>
        <span>
            @if (Model?.IsActive == true)
            {
                <span class="cell-chip on">啟用</span>
            }
            else
            {
                <span class="cell-chip off">停用</span>
            }
        </span>
    </div>
</div>

<div class="mutes-card">
    <div class="card-body">
        <dl class="row dl-clean">
            <dt class="col-sm-2">ID</dt>
            <dd class="col-sm-10">@Model.MuteId</dd>

            <dt class="col-sm-2">詞彙</dt>
            <dd class="col-sm-10">
                <span data-copy="@Model.Word" title="點擊複製">@Model.Word</span>
            </dd>

            <dt class="col-sm-2">替代字</dt>
            <dd class="col-sm-10">
                @if (!string.IsNullOrWhiteSpace(Model.Replacement))
                {
                    <span data-copy="@Model.Replacement" title="點擊複製">@Model.Replacement</span>
                }
                else
                {
                    <span class="text-muted">（預設遮罩）</span>
                }
            </dd>

            <dt class="col-sm-2">狀態</dt>
            <dd class="col-sm-10">
                @if (Model.IsActive == true)
                {
                    <span class="cell-chip on">啟用</span>
                }
                else
                {
                    <span class="cell-chip off">停用</span>
                }
            </dd>

            <dt class="col-sm-2">管理員</dt>
            <dd class="col-sm-10">
                <span title="ID: @Model.ManagerId">@managerName</span>
                <span class="text-muted ms-1">(#@Model.ManagerId)</span>
            </dd>
        </dl>

        <div class="d-flex gap-2">
            <a class="btn btn-secondary" asp-action="Index">
                <i class="fas fa-arrow-left me-1"></i>返回
            </a>

            @if (canEditThis)
            {
                <a class="btn btn-primary" asp-action="Edit" asp-route-id="@Model.MuteId">
                    <i class="fas fa-edit me-1"></i>編輯
                </a>
                <a class="btn btn-outline-danger" asp-action="Delete" asp-route-id="@Model.MuteId">
                    <i class="fas fa-trash-alt me-1"></i>刪除
                </a>
            }
        </div>
    </div>
</div>

@section Styles {
    <link href="~/lib/social_hub/css/mutes.css" rel="stylesheet" />
}
@section Scripts {
    <script src="~/lib/social_hub/js/mutes.js"></script>
}
