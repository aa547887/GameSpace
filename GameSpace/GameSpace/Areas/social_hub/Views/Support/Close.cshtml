@model GameSpace.Areas.social_hub.Models.ViewModels.CloseTicketVM
@{
    ViewData["Title"] = "結單 - 工單 #" + Model.TicketId;
}

<a class="btn btn-link mb-2" href="@Url.Action("Ticket", new { id = Model.TicketId })">← 返回工單</a>

<div class="card shadow-sm">
    <div class="card-header">
        <strong>結單確認</strong>
    </div>
    <div class="card-body">
        <dl class="row">
            <dt class="col-3">工單ID</dt>
            <dd class="col-9">@Model.TicketId</dd>
            <dt class="col-3">使用者ID</dt>
            <dd class="col-9">@Model.UserId</dd>
            <dt class="col-3">主旨</dt>
            <dd class="col-9">@Model.Subject</dd>
            <dt class="col-3">目前指派</dt>
            <dd class="col-9">@(@Model.AssignedManagerId?.ToString() ?? "未指派")</dd>
            <dt class="col-3">最後訊息時間</dt>
            <dd class="col-9">@((Model.LastMessageAt ?? Model.CreatedAt).ToString("yyyy/MM/dd HH:mm"))</dd>
        </dl>

        <form method="post" action="@Url.Action("CloseConfirm", "Support", new { area = "social_hub", id = Model.TicketId })">
            @Html.AntiForgeryToken() <!-- 防偽 -->
            <div class="mb-3">
                <label for="closeNote" class="form-label">結單備註（可留空，最多255字）</label>
                <textarea name="closeNote" id="closeNote" class="form-control" maxlength="255" rows="3"></textarea>
            </div>
            <div class="d-flex gap-2">
                <a class="btn btn-outline-secondary" href="@Url.Action("Ticket", new { id = Model.TicketId })">取消</a>
                <button type="submit" class="btn btn-danger">確認結單</button>
            </div>
        </form>
    </div>
</div>
