@model GameSpace.Areas.MiniGame.Models.AdminDashboardViewModel
@{
    ViewData["Title"] = "MiniGame 管理後台";
    Layout = "~/Areas/MiniGame/Views/Shared/_Layout.cshtml";
}

<div class="container-fluid">
    <!-- Page Heading -->
    <div class="d-sm-flex align-items-center justify-content-between mb-4">
        <h1 class="h3 mb-0 text-gray-800">MiniGame 管理後台</h1>
        <a href="#" class="d-none d-sm-inline-block btn btn-sm btn-primary shadow-sm">
            <i class="fas fa-download fa-sm text-white-50"></i> 匯出報表
        </a>
    </div>

    <!-- Content Row -->
    <div class="row">
        <!-- 總用戶數 -->
        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card border-left-primary shadow h-100 py-2">
                <div class="card-body">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">總用戶數</div>
                            <div class="h5 mb-0 font-weight-bold text-gray-800">@Model.TotalUsers</div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-users fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 活躍用戶數 -->
        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card border-left-success shadow h-100 py-2">
                <div class="card-body">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="text-xs font-weight-bold text-success text-uppercase mb-1">活躍用戶數</div>
                            <div class="h5 mb-0 font-weight-bold text-gray-800">@Model.ActiveUsers</div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-user-check fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 總寵物數 -->
        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card border-left-info shadow h-100 py-2">
                <div class="card-body">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="text-xs font-weight-bold text-info text-uppercase mb-1">總寵物數</div>
                            <div class="h5 mb-0 font-weight-bold text-gray-800">@Model.TotalPets</div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-paw fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 總遊戲次數 -->
        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card border-left-warning shadow h-100 py-2">
                <div class="card-body">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">總遊戲次數</div>
                            <div class="h5 mb-0 font-weight-bold text-gray-800">@Model.TotalMiniGames</div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-gamepad fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Content Row -->
    <div class="row">
        <!-- 今日簽到數 -->
        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card border-left-primary shadow h-100 py-2">
                <div class="card-body">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">今日簽到數</div>
                            <div class="h5 mb-0 font-weight-bold text-gray-800">@Model.TodaySignIns</div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-calendar-check fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 今日遊戲次數 -->
        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card border-left-success shadow h-100 py-2">
                <div class="card-body">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="text-xs font-weight-bold text-success text-uppercase mb-1">今日遊戲次數</div>
                            <div class="h5 mb-0 font-weight-bold text-gray-800">@Model.TodayGamePlays</div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-play fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 總點數獲得 -->
        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card border-left-info shadow h-100 py-2">
                <div class="card-body">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="text-xs font-weight-bold text-info text-uppercase mb-1">總點數獲得</div>
                            <div class="h5 mb-0 font-weight-bold text-gray-800">@Model.TotalPointsEarned</div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-coins fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 總點數消費 -->
        <div class="col-xl-3 col-md-6 mb-4">
            <div class="card border-left-warning shadow h-100 py-2">
                <div class="card-body">
                    <div class="row no-gutters align-items-center">
                        <div class="col mr-2">
                            <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">總點數消費</div>
                            <div class="h5 mb-0 font-weight-bold text-gray-800">@Model.TotalPointsSpent</div>
                        </div>
                        <div class="col-auto">
                            <i class="fas fa-shopping-cart fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Content Row -->
    <div class="row">
        <!-- 用戶成長圖表 -->
        <div class="col-xl-8 col-lg-7">
            <div class="card shadow mb-4">
                <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                    <h6 class="m-0 font-weight-bold text-primary">用戶成長趨勢</h6>
                </div>
                <div class="card-body">
                    <div class="chart-area">
                        <canvas id="userGrowthChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- 遊戲遊玩次數圖表 -->
        <div class="col-xl-4 col-lg-5">
            <div class="card shadow mb-4">
                <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                    <h6 class="m-0 font-weight-bold text-primary">遊戲遊玩次數</h6>
                </div>
                <div class="card-body">
                    <div class="chart-pie pt-4 pb-2">
                        <canvas id="gamePlayChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Content Row -->
    <div class="row">
        <!-- 快速操作 -->
        <div class="col-lg-6">
            <div class="card shadow mb-4">
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">快速操作</h6>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <a href="@Url.Action("Index", "AdminUser")" class="btn btn-primary btn-block">
                                <i class="fas fa-users"></i> 用戶管理
                            </a>
                        </div>
                        <div class="col-md-6 mb-3">
                            <a href="@Url.Action("Index", "AdminPet")" class="btn btn-success btn-block">
                                <i class="fas fa-paw"></i> 寵物管理
                            </a>
                        </div>
                        <div class="col-md-6 mb-3">
                            <a href="@Url.Action("Index", "AdminMiniGame")" class="btn btn-info btn-block">
                                <i class="fas fa-gamepad"></i> 遊戲管理
                            </a>
                        </div>
                        <div class="col-md-6 mb-3">
                            <a href="@Url.Action("Index", "AdminWallet")" class="btn btn-warning btn-block">
                                <i class="fas fa-wallet"></i> 錢包管理
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 系統狀態 -->
        <div class="col-lg-6">
            <div class="card shadow mb-4">
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">系統狀態</h6>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <div class="text-center">
                                <div class="h5 mb-0 font-weight-bold text-gray-800">@Model.TotalCoupons</div>
                                <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">優惠券總數</div>
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <div class="text-center">
                                <div class="h5 mb-0 font-weight-bold text-gray-800">@Model.TotalEVouchers</div>
                                <div class="text-xs font-weight-bold text-success text-uppercase mb-1">禮券總數</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Chart.js -->
<script src="~/lib/chart.js/Chart.min.js"></script>

<script>
// 用戶成長圖表
var ctx = document.getElementById("userGrowthChart");
var userGrowthChart = new Chart(ctx, {
    type: 'line',
    data: {
        labels: @Html.Raw(Json.Serialize(Model.UserGrowthData.Select(x => x.Date))),
        datasets: [{
            label: '用戶數',
            data: @Html.Raw(Json.Serialize(Model.UserGrowthData.Select(x => x.Count))),
            borderColor: 'rgb(75, 192, 192)',
            backgroundColor: 'rgba(75, 192, 192, 0.2)',
            tension: 0.1
        }]
    },
    options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
            y: {
                beginAtZero: true
            }
        }
    }
});

// 遊戲遊玩次數圖表
var ctx2 = document.getElementById("gamePlayChart");
var gamePlayChart = new Chart(ctx2, {
    type: 'doughnut',
    data: {
        labels: @Html.Raw(Json.Serialize(Model.GamePlayData.Select(x => x.GameType))),
        datasets: [{
            data: @Html.Raw(Json.Serialize(Model.GamePlayData.Select(x => x.Count))),
            backgroundColor: [
                '#4e73df',
                '#1cc88a',
                '#36b9cc',
                '#f6c23e',
                '#e74a3b'
            ]
        }]
    },
    options: {
        responsive: true,
        maintainAspectRatio: false
    }
});
</script>

